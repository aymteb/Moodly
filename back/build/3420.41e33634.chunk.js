"use strict";(self.webpackChunkmoodly=self.webpackChunkmoodly||[]).push([[3420],{43420:function($,m,s){s.r(m),s.d(m,{default:function(){return ds}});var t=s(74081),e=s(87006),E=s(59461),D=s(12847),l=s(27279),L=s(93153),_=s(50086),i=s(32370),x=s(10701),r=s(93415),j=s(4987),h=s(73354),C=s(27875),S=s(48102),F=s(37472),N=s(74758),Q=s(70774),b=s(38566),R=s(38101),V=s(10989),z=s(86967),q=s(78031),ss=s(26784),ts=s(78665),k=s(36938),X=s(61020),es=s(51447),ns=s(73314),T=s(70627),os=s(61815),Ds=s(40464),cs=s(64797),Ms=s(85811),Os=s(30594),Ps=s(15816),gs=s(97442),ms=s(13576),us=s(87830),hs=s(47184),Cs=s(364),Rs=s(71563),Ts=s(49204),Ls=s(47853),xs=s(75719),vs=s(74919),As=s(29206),Bs=s(98934),fs=s(43433),Is=s(8175);const as=()=>"todo empty role",G=({id:o,name:c,description:a,usersCount:v,icons:d,rowIndex:W,canUpdate:M})=>{const{formatMessage:A}=(0,X.Z)(),[,B]=d,O=A({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:v});return(0,t.jsxs)(L.Tr,{"aria-rowindex":W,...M?(0,e.X7)({fn:B.onClick}):{},children:[(0,t.jsx)(_.Td,{maxWidth:(0,e.Q1)(130),children:(0,t.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:c})}),(0,t.jsx)(_.Td,{maxWidth:(0,e.Q1)(250),children:(0,t.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:a})}),(0,t.jsx)(_.Td,{children:(0,t.jsx)(i.Z,{textColor:"neutral800",children:O})}),(0,t.jsx)(_.Td,{children:(0,t.jsx)(x.k,{justifyContent:"flex-end",...e.UW,children:d.map((P,f)=>P?(0,t.jsx)(r.x,{paddingLeft:f===0?0:1,children:(0,t.jsx)(j.h,{onClick:P.onClick,label:P.label,noBorder:!0,icon:P.icon})},P.label):null)})})]},o)};G.propTypes={id:T.number.isRequired,name:T.string.isRequired,description:T.string.isRequired,usersCount:T.number.isRequired,icons:T.array.isRequired,rowIndex:T.number.isRequired,canUpdate:T.bool},G.defaultProps={canUpdate:!1};const ls={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},_s=(o,c)=>(0,os.ZP)(o,a=>{switch(c.type){case"ON_REMOVE_ROLES":{a.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{a.shouldRefetchData=!0,a.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{a.shouldRefetchData=!1,a.roleToDelete=null,a.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{a.roleToDelete=c.id;break}default:return a}}),is=({canCreate:o,canDelete:c,canUpdate:a,refetchRoles:v})=>{const{formatMessage:d}=(0,X.Z)(),{formatAPIError:W}=(0,e.So)(),M=(0,e.lm)(),[A,B]=(0,l.useState)(!1),{push:O}=(0,es.k6)(),[{selectedRoles:P,showModalConfirmButtonLoading:f,roleToDelete:H},U]=(0,l.useReducer)(_s,ls),{post:Y}=(0,e.tg)(),J=async()=>{try{U({type:"ON_REMOVE_ROLES"}),await Y("/admin/roles/batch-delete",{ids:[H]}),await v(),U({type:"RESET_DATA_TO_DELETE"})}catch(n){M({type:"warning",message:W(n)})}I()},p=(0,l.useCallback)(n=>{O(`/settings/roles/duplicate/${n}`)},[O]),K=()=>O("/settings/roles/new"),y=(0,l.useCallback)(n=>{U({type:"SET_ROLE_TO_DELETE",id:n}),I()},[]),I=()=>B(n=>!n),g=(0,l.useCallback)(n=>{O(`/settings/roles/${n}`)},[O]),Z=(0,l.useCallback)((n,u)=>{n.preventDefault(),n.stopPropagation(),u.usersCount?M({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):y(u.id)},[M,y]),w=(0,l.useCallback)((n,u)=>{n.preventDefault(),n.stopPropagation(),p(u.id)},[p]),Es=(0,l.useCallback)(n=>[...o?[{onClick:u=>w(u,n),label:d({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:(0,t.jsx)(q.Z,{})}]:[],...a?[{onClick:()=>g(n.id),label:d({id:"app.utils.edit",defaultMessage:"Edit"}),icon:(0,t.jsx)(ss.Z,{})}]:[],...c?[{onClick:u=>Z(u,n),label:d({id:"global.delete",defaultMessage:"Delete"}),icon:(0,t.jsx)(ts.Z,{})}]:[]],[d,Z,w,g,o,a,c]);return{handleNewRoleClick:K,getIcons:Es,selectedRoles:P,isWarningDeleteAllOpened:A,showModalConfirmButtonLoading:f,handleToggleModal:I,handleDeleteData:J}},rs=()=>{const{formatMessage:o}=(0,X.Z)();(0,e.go)();const c=(0,E.v9)(D.s),[{query:a}]=(0,e.Kx)(),{isLoading:v,allowedActions:{canCreate:d,canDelete:W,canRead:M,canUpdate:A}}=(0,e.ss)(c.settings.roles),{roles:B,isLoading:O,refetch:P}=(0,ns.u)({filters:a?._q?{name:{$containsi:a._q}}:void 0},{cacheTime:0,enabled:!v&&M}),{handleNewRoleClick:f,getIcons:H,isWarningDeleteAllOpened:U,showModalConfirmButtonLoading:Y,handleToggleModal:J,handleDeleteData:p}=is({refetchRoles:P,canCreate:d,canDelete:W,canUpdate:A}),K=B.length+1,y=6;if(v)return(0,t.jsx)(h.o,{children:(0,t.jsx)(e.dO,{})});const I=o({id:"global.roles",defaultMessage:"roles"});return(0,t.jsxs)(h.o,{children:[(0,t.jsx)(e.SL,{name:"Roles"}),(0,t.jsx)(C.T,{primaryAction:d?(0,t.jsx)(S.z,{onClick:f,startIcon:(0,t.jsx)(k.Z,{}),size:"S",children:o({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,title:I,subtitle:o({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),M&&(0,t.jsx)(F.Z,{startActions:(0,t.jsx)(e.m,{label:o({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:I})})}),M&&(0,t.jsxs)(N.D,{children:[(0,t.jsxs)(Q.i,{colCount:y,rowCount:K,footer:d?(0,t.jsx)(b.c,{onClick:f,icon:(0,t.jsx)(k.Z,{}),children:o({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,children:[(0,t.jsx)(R.h,{children:(0,t.jsxs)(L.Tr,{"aria-rowindex":1,children:[(0,t.jsx)(_.Th,{children:(0,t.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:o({id:"global.name",defaultMessage:"Name"})})}),(0,t.jsx)(_.Th,{children:(0,t.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:o({id:"global.description",defaultMessage:"Description"})})}),(0,t.jsx)(_.Th,{children:(0,t.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:o({id:"global.users",defaultMessage:"Users"})})}),(0,t.jsx)(_.Th,{children:(0,t.jsx)(V.T,{children:o({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,t.jsx)(z.p,{children:B?.map((g,Z)=>(0,t.jsx)(G,{id:g.id,name:g.name,description:g.description,usersCount:g.usersCount,icons:H(g),rowIndex:Z+2,canUpdate:A},g.id))})]}),!K&&!O&&(0,t.jsx)(as,{})]}),(0,t.jsx)(e.QH,{isOpen:U,onConfirm:p,isConfirmButtonLoading:Y,onToggleDialog:J})]})},ds=()=>{const o=(0,E.v9)(D.s);return(0,t.jsx)(e.O4,{permissions:o.settings.roles.main,children:(0,t.jsx)(rs,{})})}},73314:function($,m,s){s.d(m,{u:function(){return l}});var t=s(27279),e=s(87006),E=s(61020),D=s(40464);const l=(L={},_={})=>{const{id:i="",...x}=L,{get:r}=(0,e.kY)(),{locale:j}=(0,E.Z)(),h=(0,e.Xe)(j,{sensitivity:"base"}),{data:C,error:S,isError:F,isLoading:N,refetch:Q}=(0,D.useQuery)(["roles",i,x],async()=>{const{data:R}=await r(`/admin/roles/${i??""}`,{params:x});return R},_);return{roles:t.useMemo(()=>{let R=[];return C&&(Array.isArray(C.data)?R=C.data:R=[C.data]),[...R].sort((V,z)=>h.compare(V.name,z.name))},[C,h]),error:S,isError:F,isLoading:N,refetch:Q}}},37472:function($,m,s){s.d(m,{Z:function(){return E}});var t=s(74081),e=s(10701);const E=({startActions:D,endActions:l})=>!D&&!l?null:(0,t.jsxs)(e.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,t.jsx)(e.k,{gap:2,wrap:"wrap",children:D}),(0,t.jsx)(e.k,{gap:2,shrink:0,wrap:"wrap",children:l})]})},38566:function($,m,s){s.d(m,{c:function(){return x}});var t=s(74081),e=s(72450),E=s(93415),D=s(84366),l=s(10701),L=s(32370);const _=(0,e.ZP)(E.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:r})=>r.colors.primary600};
  }
`,i=(0,e.ZP)(E.x)`
  border-radius: 0 0 ${({theme:r})=>r.borderRadius} ${({theme:r})=>r.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,x=({children:r,icon:j,...h})=>(0,t.jsxs)("div",{children:[(0,t.jsx)(D.i,{}),(0,t.jsx)(i,{as:"button",background:"primary100",padding:5,...h,children:(0,t.jsxs)(l.k,{children:[(0,t.jsx)(_,{"aria-hidden":!0,background:"primary200",children:j}),(0,t.jsx)(E.x,{paddingLeft:3,children:(0,t.jsx)(L.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:r})})]})})]})}}]);
